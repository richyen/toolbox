create public database link oracle_server connect to system identified by 'oracle' using oci '//whatismyip/XE';
create extension oracle_fdw;

CREATE SERVER oradb FOREIGN DATA WRAPPER oracle_fdw OPTIONS (dbserver '//whatismyip/XE');
GRANT USAGE ON FOREIGN SERVER oradb TO enterprisedb;
CREATE USER MAPPING FOR enterprisedb SERVER oradb OPTIONS (user 'system', password 'oracle');

create foreign table ps_job
(
jobid number(5),
jobname varchar2(15),
jobfrequency varchar2(15),
jobtype varchar2(15),
joblocation varchar2(15),
deptid number(5),
jobcode number(5),
position_nbr number(5),
supervisor_id number(5),
hr_status number(5),
col_1 varchar2(15),
col_2 varchar2(15),
col_3 varchar2(15),
col_4 varchar2(15),
col_5 varchar2(15),
col_6 varchar2(15),
col_7 varchar2(15),
col_8 varchar2(15),
col_9 varchar2(15),
col_10 varchar2(15),
col_11 varchar2(15),
col_12 varchar2(15),
col_13 varchar2(15),
col_14 varchar2(15),
col_15 varchar2(15),
col_16 varchar2(15),
col_17 varchar2(15),
col_18 varchar2(15),
col_19 varchar2(15),
col_20 varchar2(15),
col_21 varchar2(15),
col_22 varchar2(15),
col_23 varchar2(15),
col_24 varchar2(15),
col_25 varchar2(15),
col_26 varchar2(15),
col_27 varchar2(15),
col_28 varchar2(15),
col_29 varchar2(15),
col_30 varchar2(15),
col_31 varchar2(15),
col_32 varchar2(15),
col_33 varchar2(15),
col_34 varchar2(15),
col_35 varchar2(15),
col_36 varchar2(15),
col_37 varchar2(15),
col_38 varchar2(15),
col_39 varchar2(15),
col_40 varchar2(15),
col_41 varchar2(15),
col_42 varchar2(15),
col_43 varchar2(15),
col_44 varchar2(15),
col_45 varchar2(15),
col_46 varchar2(15),
col_47 varchar2(15),
col_48 varchar2(15),
col_49 varchar2(15),
col_50 varchar2(15),
col_51 varchar2(15),
col_52 varchar2(15),
col_53 varchar2(15),
col_54 varchar2(15),
col_55 varchar2(15),
col_56 varchar2(15),
col_57 varchar2(15),
col_58 varchar2(15),
col_59 varchar2(15),
col_60 varchar2(15),
col_61 varchar2(15),
col_62 varchar2(15),
col_63 varchar2(15),
col_64 varchar2(15),
col_65 varchar2(15),
col_66 varchar2(15),
col_67 varchar2(15),
col_68 varchar2(15),
col_69 varchar2(15),
col_70 varchar2(15),
col_71 varchar2(15),
col_72 varchar2(15),
col_73 varchar2(15),
col_74 varchar2(15),
col_75 varchar2(15),
col_76 varchar2(15),
col_77 varchar2(15),
col_78 varchar2(15),
col_79 varchar2(15),
col_80 varchar2(15),
col_81 varchar2(15),
col_82 varchar2(15),
col_83 varchar2(15),
col_84 varchar2(15),
col_85 varchar2(15),
col_86 varchar2(15),
col_87 varchar2(15),
col_88 varchar2(15),
col_89 varchar2(15),
col_90 varchar2(15),
col_91 varchar2(15),
col_92 varchar2(15),
col_93 varchar2(15),
col_94 varchar2(15),
col_95 varchar2(15),
col_96 varchar2(15),
col_97 varchar2(15),
col_98 varchar2(15),
col_99 varchar2(15),
col_100 varchar2(15),
col_101 varchar2(15),
col_102 varchar2(15),
col_103 varchar2(15),
col_104 varchar2(15),
col_105 varchar2(15),
col_106 varchar2(15),
col_107 varchar2(15),
col_108 varchar2(15),
col_109 varchar2(15),
col_110 varchar2(15),
col_111 varchar2(15),
col_112 varchar2(15),
col_113 varchar2(15),
col_114 varchar2(15),
col_115 varchar2(15),
col_116 varchar2(15),
col_117 varchar2(15),
col_118 varchar2(15),
col_119 varchar2(15),
col_120 varchar2(15),
col_121 varchar2(15),
col_122 varchar2(15),
col_123 varchar2(15),
col_124 varchar2(15),
col_125 varchar2(15),
col_126 varchar2(15),
col_127 varchar2(15),
col_128 varchar2(15),
col_129 varchar2(15),
col_130 varchar2(15),
col_131 varchar2(15),
col_132 varchar2(15),
col_133 varchar2(15),
col_134 varchar2(15),
col_135 varchar2(15),
col_136 varchar2(15),
col_137 varchar2(15),
col_138 varchar2(15),
col_139 varchar2(15),
col_140 varchar2(15),
col_141 varchar2(15),
col_142 varchar2(15),
col_143 varchar2(15),
col_144 varchar2(15),
col_145 varchar2(15),
col_146 varchar2(15),
col_147 varchar2(15),
col_148 varchar2(15),
col_149 varchar2(15),
col_150 varchar2(15),
col_151 varchar2(15),
col_152 varchar2(15),
col_153 varchar2(15),
col_154 varchar2(15),
col_155 varchar2(15),
col_156 varchar2(15),
col_157 varchar2(15),
col_158 varchar2(15),
col_159 varchar2(15),
col_160 varchar2(15),
) server oradb options (schema 'SYSTEM', table 'PS_JOB');

create foreign table ps_job_small
(
jobid number(5),
jobname varchar2(15),
jobfrequency varchar2(15),
jobtype varchar2(15),
joblocation varchar2(15),
deptid number(5),
jobcode number(5),
position_nbr number(5),
supervisor_id number(5),
hr_status number(5)
) server oradb options (schema 'SYSTEM', table 'PS_JOB_SMALL');

explain (verbose, analyze, buffers) select DEPTID,JOBCODE,POSITION_NBR,SUPERVISOR_ID,HR_STATUS from ps_job;
explain (verbose, analyze, buffers) select DEPTID,JOBCODE,POSITION_NBR,SUPERVISOR_ID,HR_STATUS from system.ps_job@oracle_server;
explain (verbose, analyze, buffers) select DEPTID,JOBCODE,POSITION_NBR,SUPERVISOR_ID,HR_STATUS from ps_job_small;
explain (verbose, analyze, buffers) select DEPTID,JOBCODE,POSITION_NBR,SUPERVISOR_ID,HR_STATUS from system.ps_job_small@oracle_server;
